{
  "schemaVersion": "2.2",
  "description": "Custom SSM Document to install Chrome",
  "mainSteps": [
    {
      "action": "aws:runPowerShellScript",
      "name": "WBUILDER_InstallChrome",
      "inputs": {
        "runCommand": [
          "$LocalTempDir   = $env:TEMP",
          "$ChromeInstaller = \"chrome_installer.msi\"",
          "$DownloadUrl = 'https://dl.google.com/dl/chrome/install/googlechromestandaloneenterprise64.msi'",
          "",
          "# Disable progress bar for faster/silent download",
          "$ProgressPreference = 'SilentlyContinue'",
          "",
          "Write-Output \"Downloading Chrome MSI...\"",
          "Invoke-WebRequest -Uri $DownloadUrl -OutFile \"$LocalTempDir\\$ChromeInstaller\" -UseBasicParsing",
          "",
          "Write-Output \"Installing Chrome silently...\"",
          "Start-Process msiexec.exe -ArgumentList \"/i `\"$LocalTempDir\\$ChromeInstaller`\" /qn /norestart\" -Wait",
          "",
          "Write-Output \"Cleaning up installer...\"",
          "Remove-Item \"$LocalTempDir\\$ChromeInstaller\" -Force -ErrorAction SilentlyContinue",
          "",
          "Write-Output \"Chrome installation complete.\""
        ]
      }
    }
  ]
}
