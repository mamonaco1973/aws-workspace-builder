{
  "schemaVersion": "2.2",
  "description": "Install Notepad++ silently",
  "mainSteps": [
    {
      "action": "aws:runPowerShellScript",
      "name": "InstallNotepadPP",
      "inputs": {
        "runCommand": [
          "$ErrorActionPreference = 'Stop'",
          "",
          "$LocalTempDir = $env:TEMP",
          "$Installer = 'npp_installer.exe'",
          "$DownloadUrl = 'https://github.com/notepad-plus-plus/notepad-plus-plus/releases/download/v8.8.5/npp.8.8.5.Installer.x64.exe'",
          "",
          "# Disable progress bar for faster/silent download",
          "$ProgressPreference = 'SilentlyContinue'",
          "",
          "Write-Output \"Downloading Notepad++ installer...\"",
          "try {",
          "  Invoke-WebRequest -Uri $DownloadUrl -OutFile \"$LocalTempDir\\$Installer\"",
          "} catch {",
          "  Write-Output \"ERROR: Failed to download Notepad++: $($_.Exception.Message)\"",
          "  exit 1",
          "}",
          "",
          "Write-Output \"Installing Notepad++ silently...\"",
          "Start-Process -FilePath \"$LocalTempDir\\$Installer\" -ArgumentList '/S' -Wait",
          "if ($LASTEXITCODE -ne 0) {",
          "  Write-Output \"ERROR: Notepad++ installer failed with exit code $LASTEXITCODE\"",
          "  exit $LASTEXITCODE",
          "}",
          "",
          "Write-Output \"Cleaning up installer...\"",
          "Remove-Item \"$LocalTempDir\\$Installer\" -Force -ErrorAction SilentlyContinue",
          "",
          "Write-Output \"Notepad++ installation complete.\"",
          "exit 0"
        ]
      }
    }
  ]
}
