{
  "schemaVersion": "2.2",
  "description": "Install Notepad++ silently",
  "mainSteps": [
    {
      "action": "aws:runPowerShellScript",
      "name": "InstallNotepadPP",
      "inputs": {
        "runCommand": [
          "$LocalTempDir = $env:TEMP",
          "$Installer = 'npp_installer.exe'",
          "$DownloadUrl = 'https://github.com/notepad-plus-plus/notepad-plus-plus/releases/download/v8.7.5/npp.8.7.5.Installer.x64.exe'",
          "$ProgressPreference = 'SilentlyContinue'",
          "Invoke-WebRequest -Uri $DownloadUrl -OutFile \"$LocalTempDir\\$Installer\"",
          "Start-Process -FilePath \"$LocalTempDir\\$Installer\" -ArgumentList '/S' -Wait",
          "Remove-Item \"$LocalTempDir\\$Installer\" -Force -ErrorAction SilentlyContinue"
        ]
      }
    }
  ]
}
